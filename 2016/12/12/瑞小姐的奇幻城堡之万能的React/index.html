<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>瑞小姐的奇幻城堡之万能的React | 酶窝</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/app.css">
  <!-- <link rel='stylesheet' href='http://fonts.useso.com/css?family=Source+Code+Pro'> -->
</head>

<body>
  <nav class="app-nav">
  
    
      <a href="/.">home</a>
    
  
    
      <a href="/archives">archive</a>
    
  
    
      <a href="/atom.xml">rss</a>
    
  
</nav>

  <main class="post">
  <article>
  <h1 class="article-title">
    <a href="/2016/12/12/瑞小姐的奇幻城堡之万能的React/">瑞小姐的奇幻城堡之万能的React</a>
  </h1>

  <section class="article-meta">
    <p class="article-date">December 12 2016</p>
  </section>

  <section class="article-entry">
    <h1 id="瑞小姐的奇幻城堡之万能的React"><a href="#瑞小姐的奇幻城堡之万能的React" class="headerlink" title="瑞小姐的奇幻城堡之万能的React"></a>瑞小姐的奇幻城堡之万能的React</h1><h2 id="用React编写桌面程序"><a href="#用React编写桌面程序" class="headerlink" title="用React编写桌面程序"></a>用React编写桌面程序</h2><blockquote>
<p>React如何编写桌面程序</p>
</blockquote>
<p>atom-shell：由国人赵成开发完成<br>表面上是桌面程序，本质上是封装了 Chromium 内核<br>因此可以直接将网页封装成桌面程序</p>
<blockquote>
<p>实例演示</p>
</blockquote>
<p>1、桌面应用</p>
<pre><code><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>万能的React<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./css/jquery.flipster.min.css"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./css/styles.css"</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flipster"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"react"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery.flipster.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/react-0.13.2/react-0.13.2/build/react.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./js/stats.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./js/script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure>
</code></pre><h2 id="用React编写游戏"><a href="#用React编写游戏" class="headerlink" title="用React编写游戏"></a>用React编写游戏</h2><blockquote>
<p>游戏的本质</p>
</blockquote>
<p>游戏的本质就是循环+状态<br>游戏内部有一个无限循环，每次循环根据当前状态创建游戏世界<br>恰好和 React 的状态思想对应</p>
<blockquote>
<p>实例演示</p>
</blockquote>
<p>2、游戏</p>
<pre><code><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div></pre></td><td class="code"><pre><div class="line">   <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">title</span>&gt;</span>万能的React<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></div><div class="line">       .app&#123;</div><div class="line">           margin:10px;</div><div class="line">           font-family: arial;</div><div class="line">       &#125;</div><div class="line">       .board&#123;</div><div class="line">           display:block;</div><div class="line">           position:relative;</div><div class="line">           margin:10px 0px 10px 0px;</div><div class="line">           border:1px solid #ccc;</div><div class="line">           width:215px;</div><div class="line">           height:215px;</div><div class="line">           padding:5px;</div><div class="line">       &#125;</div><div class="line">       .board span&#123;</div><div class="line">           font-family: arial;</div><div class="line">           letter-spacing: -1px;</div><div class="line">           display:block;</div><div class="line">           width:50px;</div><div class="line">           height:36px;</div><div class="line">           position:absolute;</div><div class="line">           text-align:center;</div><div class="line">           color:white;</div><div class="line">           font-weight:bold;</div><div class="line">           font-size:20px;</div><div class="line">           padding-top:14px;</div><div class="line">           background-color:#ebe76f;</div><div class="line">           border-radius: 5px;</div><div class="line">           transition: all 100ms linear;</div><div class="line">       &#125;</div><div class="line">       .a1, .b1, .c1, .d1&#123; left:5px; &#125;</div><div class="line">       .a2, .b2, .c2, .d2&#123; left:60px; &#125;</div><div class="line">       .a3, .b3, .c3, .d3&#123; left:115px; &#125;</div><div class="line">       .a4, .b4, .c4, .d4&#123; left:170px; &#125;</div><div class="line">       .a1, .a2, .a3, .a4&#123; top:5px; &#125;</div><div class="line">       .b1, .b2, .b3, .b4&#123; top:60px; &#125;</div><div class="line">       .c1, .c2, .c3, .c4&#123; top:115px; &#125;</div><div class="line">       .d1, .d2, .d3, .d4&#123; top:170px; &#125;</div><div class="line">       span.value2&#123; background-color:#ebb26f; &#125;</div><div class="line">       span.value4&#123; background-color:#ea6feb; &#125;</div><div class="line">       span.value8&#123; background-color:#eb6fa3; &#125;</div><div class="line">       span.value16&#123; background-color:#7a6feb; &#125;</div><div class="line">       span.value32&#123; background-color:#af6feb; &#125;</div><div class="line">       span.value64&#123; background-color:#6febcf; &#125;</div><div class="line">       span.value128&#123; background-color:#6fbeeb; &#125;</div><div class="line">       span.value256&#123; background-color:#afeb6f; &#125;</div><div class="line">       span.value512&#123; background-color:#7aeb6f; &#125;</div><div class="line">       span.value1024&#123; background-color:#e4eb6f; &#125;</div><div class="line">   <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react-0.13.2/react-0.13.2/build/react.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react-0.13.2/react-0.13.2/build/JSXTransformer.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/jsx"</span>&gt;</span><span class="xml"></span></div><div class="line">       var initial_board = &#123;</div><div class="line">           a1:null,a2:null,a3:null,a4:null,</div><div class="line">           b1:null,b2:null,b3:null,b4:null,</div><div class="line">           c1:null,c2:null,c3:null,c4:null,</div><div class="line">           d1:null,d2:null,d3:null,d4:null</div><div class="line">       &#125;;</div><div class="line"></div><div class="line">       function available_spaces(board)&#123;</div><div class="line">           return Object.keys(board).filter(function(key)&#123;</div><div class="line">               return board[key] == null</div><div class="line">           &#125;);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       function used_spaces(board)&#123;</div><div class="line">           return Object.keys(board).filter(function(key)&#123;</div><div class="line">               return board[key] !== null</div><div class="line">           &#125;);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       function score_board(board)&#123;</div><div class="line">           return used_spaces(board).map(function(key)&#123;</div><div class="line">               return (board[key].values.reduce(function(a, b) &#123;</div><div class="line">                   return a + b; //sum tile values</div><div class="line">               &#125;)) - board[key].values[0]; //don't count initial value</div><div class="line">           &#125;).reduce(function(a,b)&#123;return a+b&#125;, 0);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       function tile_value(tile)&#123;</div><div class="line">           return tile ? tile.values[tile.values.length-1] : null;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       function can_move(board)&#123;</div><div class="line">           var new_board = [up,down,left,right].reduce(function(b, direction)&#123;</div><div class="line">               return fold_board(b, direction);</div><div class="line">           &#125;, board);</div><div class="line">           return available_spaces(new_board).length &gt; 0</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       function same_board(board1, board2)&#123;</div><div class="line">           return Object.keys(board1).reduce(function(ret, key)&#123;</div><div class="line">               return ret &amp;&amp; board1[key] == board2[key];</div><div class="line">           &#125;, true);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       function fold_line(board, line)&#123;</div><div class="line">           var tiles = line.map(function(key)&#123;</div><div class="line">               return board[key];</div><div class="line">           &#125;).filter(function(tile)&#123;</div><div class="line">                return tile !== null</div><div class="line">           &#125;);   </div><div class="line">           var new_tiles = [];</div><div class="line">           if(tiles)&#123;</div><div class="line">               //must loop so we can skip next if matched</div><div class="line">               for(var i=0; i <span class="tag">&lt; <span class="attr">tiles.length</span>; <span class="attr">i</span>++)&#123;</span></div><div class="line">                  <span class="attr">var</span> <span class="attr">tile</span> = <span class="string">tiles[i];</span></div><div class="line">                  <span class="attr">if</span>(<span class="attr">tile</span>)&#123;</div><div class="line">                      <span class="attr">var</span> <span class="attr">val</span> = <span class="string">tile_value(tile);</span></div><div class="line">                      <span class="attr">var</span> <span class="attr">next_tile</span> = <span class="string">tiles[i+1];</span></div><div class="line">                       <span class="attr">if</span>(<span class="attr">next_tile</span> &amp;&amp; <span class="attr">val</span> == <span class="string">tile_value(next_tile))&#123;</span></div><div class="line">                           //<span class="attr">skip</span> <span class="attr">next</span> <span class="attr">tile</span>;</div><div class="line">                           <span class="attr">i</span>++;</div><div class="line">                           <span class="attr">new_tiles.push</span>(&#123;</div><div class="line">                               <span class="attr">id:</span> <span class="attr">next_tile.id</span>, //<span class="attr">keep</span> <span class="attr">id</span></div><div class="line">                               <span class="attr">values:</span> <span class="attr">tile.values.concat</span>([<span class="attr">val</span> * <span class="attr">2</span>])</div><div class="line">                           &#125;);</div><div class="line">                       &#125;</div><div class="line">                       <span class="attr">else</span>&#123;</div><div class="line">                           <span class="attr">new_tiles.push</span>(<span class="attr">tile</span>);</div><div class="line">                       &#125;</div><div class="line">                   &#125;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">           <span class="attr">var</span> <span class="attr">new_line</span> = <span class="string">&#123;&#125;;</span></div><div class="line">           <span class="attr">line.forEach</span>(<span class="attr">function</span>(<span class="attr">key</span>, <span class="attr">i</span>)&#123;</div><div class="line">               <span class="attr">new_line</span>[<span class="attr">key</span>] = <span class="string">new_tiles[i]</span> || <span class="attr">null</span>;</div><div class="line">           &#125;);</div><div class="line">           <span class="attr">return</span> <span class="attr">new_line</span>;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="attr">function</span> <span class="attr">fold_order</span>(<span class="attr">xs</span>, <span class="attr">ys</span>, <span class="attr">reverse_keys</span>)&#123;</div><div class="line">           <span class="attr">return</span> <span class="attr">xs.map</span>(<span class="attr">function</span>(<span class="attr">x</span>)&#123;</div><div class="line">               <span class="attr">return</span> <span class="attr">ys.map</span>(<span class="attr">function</span>(<span class="attr">y</span>)&#123;</div><div class="line">                   <span class="attr">var</span> <span class="attr">key</span> = <span class="string">[x,y];</span></div><div class="line">                   <span class="attr">if</span>(<span class="attr">reverse_keys</span>)&#123;</div><div class="line">                       <span class="attr">return</span> <span class="attr">key.reverse</span>()<span class="attr">.join</span>("");</div><div class="line">                   &#125;</div><div class="line">                   <span class="attr">return</span> <span class="attr">key.join</span>("");</div><div class="line">               &#125;);</div><div class="line">           &#125;);</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="attr">function</span> <span class="attr">fold_board</span>(<span class="attr">board</span>, <span class="attr">lines</span>)&#123;</div><div class="line">           //<span class="attr">copy</span> <span class="attr">reference</span></div><div class="line">           <span class="attr">var</span> <span class="attr">new_board</span> = <span class="string">board;</span></div><div class="line">           <span class="attr">lines.forEach</span>(<span class="attr">function</span>(<span class="attr">line</span>)&#123;</div><div class="line">               <span class="attr">var</span> <span class="attr">new_line</span> = <span class="string">fold_line(board,</span> <span class="attr">line</span>);</div><div class="line">               <span class="attr">Object.keys</span>(<span class="attr">new_line</span>)<span class="attr">.forEach</span>(<span class="attr">function</span>(<span class="attr">key</span>)&#123;</div><div class="line">                   //<span class="attr">mutate</span> <span class="attr">reference</span> <span class="attr">while</span> <span class="attr">building</span> <span class="attr">up</span> <span class="attr">board</span></div><div class="line">                   <span class="attr">new_board</span> = <span class="string">set_tile(new_board,</span> <span class="attr">key</span>, <span class="attr">new_line</span>[<span class="attr">key</span>]);</div><div class="line">               &#125;);</div><div class="line">           &#125;);</div><div class="line">           <span class="attr">return</span> <span class="attr">new_board</span>;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="attr">var</span> <span class="attr">tile_counter</span> = <span class="string">0;</span></div><div class="line">       <span class="attr">function</span> <span class="attr">new_tile</span>(<span class="attr">initial</span>)&#123;</div><div class="line">           <span class="attr">return</span> &#123;</div><div class="line">               <span class="attr">id:</span> <span class="attr">tile_counter</span>++,</div><div class="line">               <span class="attr">values:</span> [<span class="attr">initial</span>]</div><div class="line">           &#125;;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="attr">function</span> <span class="attr">set_tile</span>(<span class="attr">board</span>, <span class="attr">where</span>, <span class="attr">tile</span>)&#123;</div><div class="line">           //<span class="attr">do</span> <span class="attr">not</span> <span class="attr">destory</span> <span class="attr">the</span> <span class="attr">old</span> <span class="attr">board</span></div><div class="line">           <span class="attr">var</span> <span class="attr">new_board</span> = <span class="string">&#123;&#125;;</span></div><div class="line">           <span class="attr">Object.keys</span>(<span class="attr">board</span>)<span class="attr">.forEach</span>(<span class="attr">function</span>(<span class="attr">key</span>, <span class="attr">i</span>)&#123;</div><div class="line">               //<span class="attr">copy</span> <span class="attr">by</span> <span class="attr">reference</span> <span class="attr">for</span> <span class="attr">structual</span> <span class="attr">sharing</span></div><div class="line">               <span class="attr">new_board</span>[<span class="attr">key</span>] = <span class="string">(key</span> == <span class="string">where)</span> ? <span class="attr">tile</span> <span class="attr">:</span> <span class="attr">board</span>[<span class="attr">key</span>];</div><div class="line">           &#125;);</div><div class="line">           <span class="attr">return</span> <span class="attr">new_board</span>;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       <span class="attr">var</span> <span class="attr">left</span> = <span class="string">fold_order([</span>"<span class="attr">a</span>","<span class="attr">b</span>","<span class="attr">c</span>","<span class="attr">d</span>"], ["<span class="attr">1</span>","<span class="attr">2</span>","<span class="attr">3</span>","<span class="attr">4</span>"], <span class="attr">false</span>);</div><div class="line">       <span class="attr">var</span> <span class="attr">right</span> = <span class="string">fold_order([</span>"<span class="attr">a</span>","<span class="attr">b</span>","<span class="attr">c</span>","<span class="attr">d</span>"], ["<span class="attr">4</span>","<span class="attr">3</span>","<span class="attr">2</span>","<span class="attr">1</span>"], <span class="attr">false</span>);</div><div class="line">       <span class="attr">var</span> <span class="attr">up</span> = <span class="string">fold_order([</span>"<span class="attr">1</span>","<span class="attr">2</span>","<span class="attr">3</span>","<span class="attr">4</span>"], ["<span class="attr">a</span>","<span class="attr">b</span>","<span class="attr">c</span>","<span class="attr">d</span>"], <span class="attr">true</span>);</div><div class="line">       <span class="attr">var</span> <span class="attr">down</span> = <span class="string">fold_order(</span> ["<span class="attr">1</span>","<span class="attr">2</span>","<span class="attr">3</span>","<span class="attr">4</span>"], ["<span class="attr">d</span>","<span class="attr">c</span>","<span class="attr">b</span>","<span class="attr">a</span>"], <span class="attr">true</span>);</div><div class="line"></div><div class="line">       <span class="attr">var</span> <span class="attr">GameBoard</span> = <span class="string">React.createClass(&#123;</span></div><div class="line">           <span class="attr">getInitialState:</span> <span class="attr">function</span>()&#123;</div><div class="line">               <span class="attr">return</span> <span class="attr">this.addTile</span>(<span class="attr">this.addTile</span>(<span class="attr">initial_board</span>));</div><div class="line">           &#125;,</div><div class="line">           <span class="attr">keyHandler:function</span>(<span class="attr">e</span>)&#123;</div><div class="line">               <span class="attr">var</span> <span class="attr">directions</span> = <span class="string">&#123;</span></div><div class="line">                   <span class="attr">37:</span> <span class="attr">left</span>,</div><div class="line">                   <span class="attr">38:</span> <span class="attr">up</span>,</div><div class="line">                   <span class="attr">39:</span> <span class="attr">right</span>,</div><div class="line">                   <span class="attr">40:</span> <span class="attr">down</span></div><div class="line">               &#125;;</div><div class="line">               <span class="attr">if</span>(<span class="attr">directions</span>[<span class="attr">e.keyCode</span>]</div><div class="line">               &amp;&amp; <span class="attr">this.setBoard</span>(<span class="attr">fold_board</span>(<span class="attr">this.state</span>, <span class="attr">directions</span>[<span class="attr">e.keyCode</span>]))</div><div class="line">               &amp;&amp; <span class="attr">Math.floor</span>(<span class="attr">Math.random</span>() * <span class="attr">30</span>, <span class="attr">0</span>) &gt; 0)&#123;</div><div class="line">                   setTimeout(function()&#123;</div><div class="line">                        this.setBoard(this.addTile(this.state));</div><div class="line">                   &#125;.bind(this), 100);</div><div class="line">               &#125;</div><div class="line">           &#125;,</div><div class="line">           setBoard:function(new_board)&#123;</div><div class="line">               if(!same_board(this.state, new_board))&#123;</div><div class="line">                   this.setState(new_board);</div><div class="line">                   return true;</div><div class="line">               &#125;</div><div class="line">               return false;</div><div class="line">           &#125;,</div><div class="line">           addTile:function(board)&#123;</div><div class="line">               var location = available_spaces(board).sort(function() &#123;</div><div class="line">                 return .5 - Math.random();</div><div class="line">               &#125;).pop();</div><div class="line">               if(location)&#123;</div><div class="line">                   var two_or_four = Math.floor(Math.random() * 2, 0) ? 2 : 4;</div><div class="line">                   return set_tile(board, location, new_tile(two_or_four));</div><div class="line">               &#125;</div><div class="line">               return board;</div><div class="line">           &#125;,</div><div class="line">           newGame:function()&#123;</div><div class="line">               this.setState(this.getInitialState());</div><div class="line">           &#125;,</div><div class="line">           componentDidMount:function()&#123;</div><div class="line">               window.addEventListener("keydown", this.keyHandler, false);</div><div class="line">           &#125;,</div><div class="line">           render:function()&#123;</div><div class="line">               var status = !can_move(this.state)?" - Game Over!":"";</div><div class="line">               return <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">"score"</span>&gt;</span></div><div class="line">                       Score: &#123;score_board(this.state)&#125;&#123;status&#125;</div><div class="line">                   <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">Tiles</span> <span class="attr">board</span>=<span class="string">&#123;this.state&#125;/</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.newGame&#125;</span>&gt;</span>New Game<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line"></div><div class="line">       var Tiles = React.createClass(&#123;</div><div class="line">           render: function()&#123;</div><div class="line">               var board = this.props.board;</div><div class="line">               //sort board keys first to stop re-ordering of DOM elements</div><div class="line">               var tiles = used_spaces(board).sort(function(a, b) &#123;</div><div class="line">                   return board[a].id - board[b].id;</div><div class="line">               &#125;);</div><div class="line">               return <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"board"</span>&gt;</span>&#123;</div><div class="line">                   tiles.map(function(key)&#123;</div><div class="line">                       var tile = board[key];</div><div class="line">                       var val = tile_value(tile);</div><div class="line">                       return <span class="tag">&lt;<span class="name">span</span> <span class="attr">key</span>=<span class="string">&#123;tile.id&#125;</span> <span class="attr">className</span>=<span class="string">&#123;key</span> + " <span class="attr">value</span>" + <span class="attr">val</span>&#125;&gt;</span></div><div class="line">                               &#123;val&#125;</div><div class="line">                              <span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</div><div class="line">               &#125;)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line"></div><div class="line">       React.render(<span class="tag">&lt;<span class="name">GameBoard</span> /&gt;</span>, document.body);</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure>
</code></pre><h2 id="用React编写邮件"><a href="#用React编写邮件" class="headerlink" title="用React编写邮件"></a>用React编写邮件</h2><blockquote>
<p>邮件简介</p>
</blockquote>
<p>MIME：Multipurpose Internet Mail Extensions<br>最早的邮件是纯文本，只能包含 ASCII 字符，MIME 对其进行了扩充<br>不仅扩充了邮件的功能，也扩充了邮件内容的展示形式和编码方式<br>我们在邮箱中看到的样式美观、可以操作的邮件，本质上就是 HTML 页面<br>因此，就可以使用 React 编写 HTML 格式的邮件</p>
<blockquote>
<p>实例演示</p>
</blockquote>
<p>3、email</p>
<pre><code><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">   <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react-0.13.2/react-0.13.2/build/react.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react-0.13.2/react-0.13.2/build/JSXTransformer.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/jsx"</span>&gt;</span><span class="xml"></span></div><div class="line">       var Email = React.createClass(&#123;</div><div class="line">           render: function () &#123;</div><div class="line">               return (</div><div class="line">               <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">                       &#123;this.props.children&#125; </div><div class="line">                   <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">html</span>&gt;</span> );</div><div class="line">           &#125; </div><div class="line">       &#125;);</div><div class="line">       var SurveyEmail = React.createClass(&#123;</div><div class="line">           render: function () &#123;</div><div class="line">               var survey = this.props.survey;</div><div class="line">               var completions = survey.activity.reduce(function (memo, a) &#123;</div><div class="line">                   return memo + a;</div><div class="line">               &#125;, 0);</div><div class="line">               var daysRunning = survey.activity.length;</div><div class="line">               return (</div><div class="line">               <span class="tag">&lt;<span class="name">Email</span>&gt;</span></div><div class="line">                 <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;survey.title&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">                 <span class="tag">&lt;<span class="name">table</span> <span class="attr">className</span>=<span class="string">'for-desktop'</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">tr</span>&gt;</span> </div><div class="line">                   <span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">                       完成任务数量：&#123;completions&#125;</div><div class="line">                   <span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">                       工作天数：&#123;daysRunning&#125;</div><div class="line">                   <span class="tag">&lt;/<span class="name">td</span>&gt;</span> </div><div class="line">                   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">                 <span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">Email</span>&gt;</span>);</div><div class="line">           &#125; &#125;);</div><div class="line">       var survey = &#123;</div><div class="line">           title: "月度总结",</div><div class="line">           activity: [1, 2, 100, 500]</div><div class="line">       &#125;</div><div class="line">       React.render(<span class="tag">&lt;<span class="name">SurveyEmail</span> <span class="attr">survey</span>=<span class="string">&#123;survey&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">SurveyEmail</span>&gt;</span>, document.body);</div><div class="line">       console.log(React.renderToStaticMarkup(<span class="tag">&lt;<span class="name">SurveyEmail</span> <span class="attr">survey</span>=<span class="string">&#123;survey&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">SurveyEmail</span>&gt;</span>));</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure>
</code></pre><h2 id="用React编写图表"><a href="#用React编写图表" class="headerlink" title="用React编写图表"></a>用React编写图表</h2><blockquote>
<p>SVG简介</p>
</blockquote>
<p>SVG：Scalable Vector Graphics<br>矢量图放大缩小不会失真，位图放大缩小会失真<br>使用 SVG 可以编写各种图形、实现动画效果<br>JSX 中包含 SVG 标签，所以可以使用 React 编写图表</p>
<blockquote>
<p>实例演示</p>
</blockquote>
<p>4、图表</p>
<pre><code><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">   <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react-0.13.2/react-0.13.2/build/react.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./react-0.13.2/react-0.13.2/build/JSXTransformer.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/jsx"</span>&gt;</span><span class="xml"></span></div><div class="line">       var Sparkline = React.createClass(&#123; </div><div class="line">           render: function () &#123;</div><div class="line">               var width = 200;</div><div class="line">               var height = 200;</div><div class="line">               var path = this.generatePath(width, height,</div><div class="line">               this.props.points);</div><div class="line">               return (</div><div class="line">               <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#123;width&#125;</span> <span class="attr">height</span>=<span class="string">&#123;height&#125;</span>&gt;</span></div><div class="line">                         <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&#123;path&#125;</span> <span class="attr">stroke</span>=<span class="string">'#7ED321'</span> <span class="attr">strokeWidth</span>=<span class="string">'2'</span></span></div><div class="line">                 <span class="attr">fill</span>=<span class="string">'none'</span>/&gt;</div><div class="line">               <span class="tag">&lt;/<span class="name">svg</span>&gt;</span> );</div><div class="line">           &#125;,</div><div class="line">           generatePath: function (width, height, points) &#123; </div><div class="line">               var maxHeight = 200;</div><div class="line">               var maxWidth = points.length;</div><div class="line">               return points.map(function (p, i) &#123;</div><div class="line">               var xPct = i / maxWidth * 100;</div><div class="line">               var x = (width / 100) * xPct;</div><div class="line">               var yPct = 100 - (p / maxHeight * 100); var y = (height / 100) * yPct;</div><div class="line">               if (i === 0) &#123; return 'M0,' + y;</div><div class="line">               &#125; else &#123;</div><div class="line">               return 'L' + x + ',' + y; &#125;</div><div class="line">                     &#125;).join(' ');</div><div class="line">           &#125;</div><div class="line">       &#125;);</div><div class="line"></div><div class="line">       React.render(<span class="tag">&lt;<span class="name">Sparkline</span> <span class="attr">points</span>=<span class="string">&#123;[1,</span> <span class="attr">5</span>, <span class="attr">15</span>, <span class="attr">100</span>, <span class="attr">150</span>]&#125;&gt;</span><span class="tag">&lt;/<span class="name">Sparkline</span>&gt;</span>, document.body);</div><div class="line">   <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure>
</code></pre>
  </section>
</article>

  <div class="sharing grid">
  <section class="profile grid-item grid">
    <img class="avatar" src="/images/avatar.png" alt="avatar" />
    <div class="grid-item">
      <p class="title"> 酶窝 </p>
      <p class="subtitle"> 酶窝 </p>
    <div>
  </section>

  <section class="share-btns">
    <!-- <p> share it if you like it~ </p> -->
    <a
  class="twitter-share-button"
  data-size="large"
  data-via="DrakeLeung"
  href="https://twitter.com/intent/tweet?text= id="瑞小姐的奇幻城堡之万能的Rea"
>
  Tweet
</a>

<script>
  window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  js.async = true;
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>

  </section>
</div>


  
    
<section class="article-comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

<script>
  var disqus_shortname = 'drakeleung';
  
  var disqus_url = 'http://yoursite.com/2016/12/12/瑞小姐的奇幻城堡之万能的React/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  
</main>

</body>
</html>
